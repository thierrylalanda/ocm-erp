import{a as R}from"./chunk-JRSXECWT.js";import{a as Ve}from"./chunk-INBIJHSE.js";import{a as Me,b as Te,c as H,d as Pe,e as De,f as Oe}from"./chunk-7V5A6UDA.js";import"./chunk-56PAQBI2.js";import"./chunk-J3F46MY4.js";import"./chunk-YZ2ZCIPF.js";import"./chunk-BJHRZJ5G.js";import"./chunk-5SKCDVUK.js";import"./chunk-3P6NPTNP.js";import"./chunk-4XP2POTR.js";import"./chunk-ETTDFRY5.js";import"./chunk-MMYELGJW.js";import{a as B}from"./chunk-5Q5R2VUI.js";import"./chunk-26FPSVGJ.js";import"./chunk-IEXRXU6D.js";import"./chunk-CSQUQHMV.js";import"./chunk-IBG7KWSR.js";import"./chunk-FIUXCDVZ.js";import"./chunk-3WBD4RP4.js";import"./chunk-IPRI2H5J.js";import{a as Ue,c as M,d as Fe,f as Q,g as ye}from"./chunk-Q4K336Q3.js";import"./chunk-H5RQM42I.js";import{b as A}from"./chunk-27KQ6NAF.js";import{B as be,C as Se,d as N,f as E,h as k,i as ve,j as he,m as xe,n as Ce,q as we,r as Ee,z as Ie}from"./chunk-OZCTR5Q5.js";import{b as V}from"./chunk-6P5VJYPL.js";import"./chunk-VLYMLFWW.js";import"./chunk-5IGNUQZL.js";import"./chunk-G64D4X4E.js";import{g as _e}from"./chunk-HOOCBFFS.js";import{j as ge,k as P,l as D,y as O}from"./chunk-E22WOTPK.js";import{$b as b,Bb as G,Dc as me,Ec as de,Fc as pe,Gc as U,Ha as ee,Hc as ce,Ic as ue,Jc as fe,Lb as te,Mb as ie,Ob as re,Pb as Y,Qb as W,Rb as d,Sb as r,Sc as p,Tb as i,Tc as c,Ub as h,cb as q,fc as f,ha as X,hb as n,hc as g,ka as J,la as K,lc as ne,ma as I,mc as ae,nc as oe,ra as _,sa as v,sc as se,tc as w,ub as T,wc as o,xc as x,yc as u,zb as C,zc as le}from"./chunk-RKWTZGMB.js";import{a as j,b as z,f as S}from"./chunk-EQDQRRRY.js";var Z=new J("UpdateUserUseCase");var $=class s{constructor(t){this.userRepository=t}execute(t,e){return S(this,null,function*(){this.validateUpdateUserDto(e);let a={value:t},l=yield this.userRepository.findById(a);if(!l)throw new Error(`L'utilisateur avec l'ID ${t} n'existe pas`);if(e.email!==l.email){let y=yield this.userRepository.findByEmail(e.email);if(y&&y.id.value!==t)throw new Error(`Un autre utilisateur avec l'email ${e.email} existe d\xE9j\xE0`)}if(e.userName!==l.userName){let y=yield this.userRepository.findByUsername(e.userName);if(y&&y.id.value!==t)throw new Error(`Un autre utilisateur avec le nom d'utilisateur ${e.userName} existe d\xE9j\xE0`)}let m=Q.toUpdateCommand(e),F=z(j({},l),{societeId:m.societeId??l.societeId,nomPrenom:m.nomPrenom??l.nomPrenom,telephone:m.telephone??l.telephone,adresse:m.adresse??l.adresse,userName:m.userName??l.userName,email:m.email??l.email,statut:m.statut??l.statut,siteId:m.siteId??l.siteId,departementId:m.departementId??l.departementId,photo:m.photo??l.photo,signature:m.signature??l.signature,langue:m.langue??l.langue}),Ae=yield this.userRepository.update(F);return Q.toResponseDto(Ae)})}validateUpdateUserDto(t){let e=[];if((!t.nomPrenom||t.nomPrenom.trim().length===0)&&e.push("Le nom et pr\xE9nom sont requis"),(!t.userName||t.userName.trim().length===0)&&e.push("Le nom d'utilisateur est requis"),(!t.email||!this.isValidEmail(t.email))&&e.push("Un email valide est requis"),t.password&&t.password.trim().length>0&&t.password.trim().length<6&&e.push("Le mot de passe doit contenir au moins 6 caract\xE8res"),t.pwdText&&(!t.pwdText||t.pwdText.trim().length===0)&&e.push("Le texte du mot de passe est requis"),(!t.societeId||t.societeId<=0)&&e.push("Un identifiant de soci\xE9t\xE9 valide est requis"),(!t.siteId||t.siteId<=0)&&e.push("Un identifiant de site valide est requis"),(!t.departementId||t.departementId<=0)&&e.push("Un identifiant de d\xE9partement valide est requis"),t.statut||e.push("Le statut est requis"),e.length>0)throw new Error(`Validation \xE9chou\xE9e: ${e.join(", ")}`)}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}isValidPhoneNumber(t){return/^[\d\s\-\+\(\)]{8,20}$/.test(t)}static \u0275fac=function(e){return new(e||s)(K(Ue))};static \u0275prov=X({token:s,factory:s.\u0275fac})};function Le(s,t){if(s&1){let e=b();r(0,"div",44),h(1,"i",45),o(2),p(3,"translate"),p(4,"translate"),r(5,"button",46),f("click",function(){_(e);let l=g();return v(l.success=!1)}),i()()}if(s&2){let e=g();n(2),u(" ",e.isEditMode?c(3,1,"forms.userForm.successEdit"):c(4,3,"forms.userForm.successCreate")," ")}}function je(s,t){if(s&1){let e=b();r(0,"div",47),h(1,"i",48),o(2),r(3,"button",46),f("click",function(){_(e);let l=g();return v(l.error=null)}),i()()}if(s&2){let e=g();n(2),u(" ",e.error," ")}}function ze(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("nomPrenom")," ")}}function qe(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("email")," ")}}function Ge(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("userName")," ")}}function Ye(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g(2);n(),u(" ",e.getFieldError("password")," ")}}function We(s,t){if(s&1&&(r(0,"div",6)(1,"label",50),o(2),p(3,"translate"),r(4,"span",8),o(5,"*"),i()(),h(6,"input",51),p(7,"translate"),C(8,Ye,2,1,"div",10),i()),s&2){let e=g();n(2),u(" ",c(3,6,"forms.userForm.password")," "),n(4),w("is-invalid",e.isFieldInvalid("password")),d("placeholder",U(c(7,8,"forms.userForm.passwordPlaceholder"))),n(2),d("ngIf",e.isFieldInvalid("password"))}}function Qe(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g(2);n(),u(" ",e.getFieldError("confirmPassword")," ")}}function He(s,t){if(s&1&&(r(0,"div",6)(1,"label",52),o(2),p(3,"translate"),r(4,"span",8),o(5,"*"),i()(),h(6,"input",53),p(7,"translate"),C(8,Qe,2,1,"div",10),i()),s&2){let e=g();n(2),u(" ",c(3,6,"forms.userForm.confirmPassword")," "),n(4),w("is-invalid",e.isFieldInvalid("confirmPassword")),d("placeholder",U(c(7,8,"forms.userForm.confirmPasswordPlaceholder"))),n(2),d("ngIf",e.isFieldInvalid("confirmPassword"))}}function Ze(s,t){if(s&1&&(r(0,"div",49),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("telephone")," ")}}function Xe(s,t){if(s&1&&(r(0,"mat-option",54),o(1),i()),s&2){let e=t.$implicit;d("value",e.value),n(),u(" ",e.label," ")}}function Je(s,t){if(s&1&&(r(0,"mat-error"),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("siteId")," ")}}function Ke(s,t){if(s&1&&(r(0,"mat-option",54),o(1),i()),s&2){let e=t.$implicit;d("value",e.value),n(),u(" ",e.label," ")}}function et(s,t){if(s&1&&(r(0,"mat-error"),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("departementId")," ")}}function tt(s,t){if(s&1&&(r(0,"mat-option",54),o(1),i()),s&2){let e=t.$implicit;d("value",e.value),n(),u(" ",e.label," ")}}function it(s,t){if(s&1&&(r(0,"mat-error"),o(1),i()),s&2){let e=g();n(),u(" ",e.getFieldError("statut")," ")}}function rt(s,t){s&1&&h(0,"span",55)}function nt(s,t){s&1&&h(0,"i",56)}var L=class s{fb=I(Ie);createUserUseCase=I(M);updateUserUseCase=I(Z);siteService=I(R);departementService=I(B);authService=I(V);user;isEditMode=!1;userSaved=new G;cancelled=new G;userForm;loading=!1;error=null;success=!1;statusOptions=[{value:"ACTIF",label:"forms.userForm.statuses.ACTIF"},{value:"INACTIF",label:"forms.userForm.statuses.INACTIF"},{value:"EN_ATTENTE",label:"forms.userForm.statuses.EN_ATTENTE"}];siteOptions=[];departmentOptions=[];ngOnInit(){this.initForm(),this.loadSites(),this.loadDepartements()}ngOnChanges(){this.user&&this.isEditMode&&setTimeout(()=>{this.populateForm(this.user)},100)}initForm(){this.userForm=this.fb.group({id:[null],nomPrenom:["",[E.required,E.minLength(3)]],email:["",[E.required,E.email]],telephone:["",[E.pattern(/^[0-9+\s\-()]{10,}$/)]],adresse:[""],siteId:["",E.required],departementId:["",E.required],statut:["ACTIF",E.required],userName:["",[E.required,E.minLength(3)]],password:["",this.isEditMode?[]:[E.required,E.minLength(6)]],confirmPassword:["",this.isEditMode?[]:[E.required]],societeId:[this.authService.idUser,E.required],pwdText:[""],photo:[""],signature:[""],langue:["fr"]},{validators:this.passwordMatchValidator})}populateForm(t){this.userForm.patchValue({id:t.id,nomPrenom:t.nomPrenom,email:t.email,telephone:t.telephone||"",adresse:t.adresse||"",siteId:t.siteId||"",departementId:t.departementId||"",statut:t.statut||"ACTIF",userName:t.userName||t.email.split("@")[0],societeId:t.societeId||1,pwdText:t.pwdText||"",photo:t.photo||"",signature:t.signature||"",langue:t.langue||"fr"}),this.userForm.get("password")?.clearValidators(),this.userForm.get("confirmPassword")?.clearValidators(),this.userForm.get("password")?.updateValueAndValidity(),this.userForm.get("confirmPassword")?.updateValueAndValidity()}passwordMatchValidator(t){let e=t.get("password")?.value,a=t.get("confirmPassword")?.value;return e&&a&&e!==a?{passwordMismatch:!0}:null}onSubmit(){return S(this,null,function*(){if(this.userForm.invalid){this.markFormGroupTouched(this.userForm);return}this.loading=!0,this.error=null,this.success=!1;try{let t=this.userForm.value,e={id:t.id,nomPrenom:t.nomPrenom,email:t.email,telephone:t.telephone||"",adresse:t.adresse||"",userName:t.userName,password:t.password||"",pwdText:t.password||"",societeId:t.societeId,siteId:t.siteId,departementId:t.departementId,statut:t.statut,photo:t.photo||"",signature:t.signature||"",langue:t.langue||"fr"},a;this.isEditMode&&this.user?a=yield this.updateUserUseCase.execute(e.id,e):a=yield this.createUserUseCase.execute(e),this.success=!0,this.userSaved.emit(a),this.isEditMode||setTimeout(()=>{this.userForm.reset({statut:"ACTIF",siteId:"",departementId:"",societeId:1,langue:"fr"}),this.success=!1},2e3)}catch(t){console.error("Erreur lors de la sauvegarde de l'utilisateur:",t),this.error=t.message||"Une erreur est survenue lors de la sauvegarde. Veuillez r\xE9essayer."}finally{this.loading=!1}})}onCancel(){this.cancelled.emit()}markFormGroupTouched(t){Object.values(t.controls).forEach(e=>{e.markAsTouched(),e instanceof he&&this.markFormGroupTouched(e)})}isFieldInvalid(t){let e=this.userForm.get(t);return e?e.invalid&&(e.dirty||e.touched):!1}getFieldError(t){let e=this.userForm.get(t);if(!e||!e.errors)return"";if(e.errors.required)return"forms.validation.required";if(e.errors.email)return"forms.validation.email";if(e.errors.minlength){let a=e.errors.minlength.requiredLength;return"forms.validation.minLength".replace("{min}",a.toString())}return e.errors.pattern?"Format invalide":e.errors.passwordMismatch?"forms.validation.passwordMismatch":"Valeur invalide"}generateUsername(){let t=this.userForm.get("email")?.value;if(t&&!this.userForm.get("userName")?.value){let e=t.split("@")[0];this.userForm.get("userName")?.setValue(e)}}loadSites(){this.siteService.getSites({page:0,size:100}).subscribe({next:t=>{this.siteOptions=t.content.map(e=>({value:e.id,label:`${e.nom} (${e.code})`}))},error:t=>{console.error("Erreur lors du chargement des sites:",t),this.siteOptions=[]}})}loadDepartements(){this.departementService.getDepartements(void 0,0,100).subscribe({next:t=>{this.departmentOptions=t.content.map(e=>({value:e.id,label:e.nom}))},error:t=>{console.error("Erreur lors du chargement des d\xE9partements:",t),this.departmentOptions=[]}})}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=T({type:s,selectors:[["app-user-form"]],inputs:{user:"user",isEditMode:"isEditMode"},outputs:{userSaved:"userSaved",cancelled:"cancelled"},features:[ue([{provide:M,useClass:ye},{provide:Z,useClass:$}]),ee],decls:121,vars:108,consts:[[1,"user-form"],["class","alert alert-success alert-dismissible fade show","role","alert",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["novalidate","",1,"needs-validation",3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-column"],[1,"form-group"],["for","nomPrenom",1,"form-label"],[1,"required"],["type","text","id","nomPrenom","formControlName","nomPrenom",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngIf"],["for","email",1,"form-label"],["type","email","id","email","formControlName","email",1,"form-control",3,"blur","placeholder"],["for","userName",1,"form-label"],["type","text","id","userName","formControlName","userName",1,"form-control",3,"placeholder"],["class","form-group",4,"ngIf"],["for","telephone",1,"form-label"],["type","tel","id","telephone","formControlName","telephone",1,"form-control",3,"placeholder"],[1,"form-label"],["id","siteId","formControlName","siteId",1,"custom-mat-select","select"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["id","departementId","formControlName","departementId",1,"custom-mat-select","select"],["id","statut","formControlName","statut",1,"custom-mat-select","select"],["id","langue","formControlName","langue",1,"custom-mat-select","select"],["value","fr"],["value","en"],["value","es"],["for","adresse",1,"form-label"],["id","adresse","formControlName","adresse","rows","2",1,"form-control",3,"placeholder"],["type","hidden","formControlName","societeId"],["type","hidden","formControlName","pwdText"],["type","hidden","formControlName","photo"],["type","hidden","formControlName","signature"],[1,"form-actions"],[1,"action-buttons","d-flex","align-items-center","justify-content-between","gap-1"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],[1,"fas","fa-times","me-1"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-border spinner-border-sm me-1","role","status","aria-hidden","true",4,"ngIf"],["class","fas fa-save me-1",4,"ngIf"],[1,"form-help"],[1,"help-text"],["role","alert",1,"alert","alert-success","alert-dismissible","fade","show"],[1,"fas","fa-check-circle","me-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-circle","me-2"],[1,"invalid-feedback"],["for","password",1,"form-label"],["type","password","id","password","formControlName","password",1,"form-control",3,"placeholder"],["for","confirmPassword",1,"form-label"],["type","password","id","confirmPassword","formControlName","confirmPassword",1,"form-control",3,"placeholder"],[3,"value"],["role","status","aria-hidden","true",1,"spinner-border","spinner-border-sm","me-1"],[1,"fas","fa-save","me-1"]],template:function(e,a){e&1&&(r(0,"div",0),C(1,Le,6,5,"div",1)(2,je,4,1,"div",2),r(3,"form",3),f("ngSubmit",function(){return a.onSubmit()}),r(4,"div",4)(5,"div",5)(6,"div",6)(7,"label",7),o(8),p(9,"translate"),r(10,"span",8),o(11,"*"),i()(),h(12,"input",9),p(13,"translate"),C(14,ze,2,1,"div",10),i(),r(15,"div",6)(16,"label",11),o(17),p(18,"translate"),r(19,"span",8),o(20,"*"),i()(),r(21,"input",12),p(22,"translate"),f("blur",function(){return a.generateUsername()}),i(),C(23,qe,2,1,"div",10),i(),r(24,"div",6)(25,"label",13),o(26),p(27,"translate"),r(28,"span",8),o(29,"*"),i()(),h(30,"input",14),p(31,"translate"),C(32,Ge,2,1,"div",10),i(),C(33,We,9,10,"div",15)(34,He,9,10,"div",15),r(35,"div",6)(36,"label",16),o(37),p(38,"translate"),i(),h(39,"input",17),p(40,"translate"),C(41,Ze,2,1,"div",10),i()(),r(42,"div",5)(43,"div",6)(44,"label",18),o(45),p(46,"translate"),r(47,"span",8),o(48,"*"),i()(),r(49,"mat-select",19)(50,"mat-option",20),o(51),p(52,"translate"),i(),C(53,Xe,2,2,"mat-option",21),i(),C(54,Je,2,1,"mat-error",22),i(),r(55,"div",6)(56,"label",18),o(57),p(58,"translate"),r(59,"span",8),o(60,"*"),i()(),r(61,"mat-select",23)(62,"mat-option",20),o(63),p(64,"translate"),i(),C(65,Ke,2,2,"mat-option",21),i(),C(66,et,2,1,"mat-error",22),i(),r(67,"div",6)(68,"label",18),o(69),p(70,"translate"),r(71,"span",8),o(72,"*"),i()(),r(73,"mat-select",24),C(74,tt,2,2,"mat-option",21),i(),C(75,it,2,1,"mat-error",22),i(),r(76,"div",6)(77,"label",18),o(78),p(79,"translate"),r(80,"span",8),o(81,"*"),i()(),r(82,"mat-select",25)(83,"mat-option",26),o(84),p(85,"translate"),i(),r(86,"mat-option",27),o(87),p(88,"translate"),i(),r(89,"mat-option",28),o(90),p(91,"translate"),i()()(),r(92,"div",6)(93,"label",29),o(94),p(95,"translate"),i(),h(96,"textarea",30),p(97,"translate"),i(),h(98,"input",31)(99,"input",32)(100,"input",33)(101,"input",34),i()(),r(102,"div",35)(103,"div",36)(104,"button",37),f("click",function(){return a.onCancel()}),h(105,"i",38),o(106),p(107,"translate"),i(),r(108,"button",39),C(109,rt,1,0,"span",40)(110,nt,1,0,"i",41),o(111),p(112,"translate"),p(113,"translate"),p(114,"translate"),i()()(),r(115,"div",42)(116,"p",43)(117,"span",8),o(118,"*"),i(),o(119),p(120,"translate"),i()()()()),e&2&&(n(),d("ngIf",a.success),n(),d("ngIf",a.error),n(),d("formGroup",a.userForm),n(5),u(" ",c(9,60,"forms.userForm.fullName")," "),n(4),w("is-invalid",a.isFieldInvalid("nomPrenom")),d("placeholder",U(c(13,62,"forms.userForm.fullNamePlaceholder"))),n(2),d("ngIf",a.isFieldInvalid("nomPrenom")),n(3),u(" ",c(18,64,"forms.userForm.email")," "),n(4),w("is-invalid",a.isFieldInvalid("email")),d("placeholder",U(c(22,66,"forms.userForm.emailPlaceholder"))),n(2),d("ngIf",a.isFieldInvalid("email")),n(3),u(" ",c(27,68,"forms.userForm.username")," "),n(4),w("is-invalid",a.isFieldInvalid("userName")),d("placeholder",U(c(31,70,"forms.userForm.usernamePlaceholder"))),n(2),d("ngIf",a.isFieldInvalid("userName")),n(),d("ngIf",!a.isEditMode),n(),d("ngIf",!a.isEditMode),n(3),x(c(38,72,"forms.userForm.phone")),n(2),w("is-invalid",a.isFieldInvalid("telephone")),d("placeholder",U(c(40,74,"forms.userForm.phonePlaceholder"))),n(2),d("ngIf",a.isFieldInvalid("telephone")),n(4),u("",c(46,76,"forms.userForm.site")," "),n(4),w("is-invalid",a.isFieldInvalid("siteId")),n(2),x(c(52,78,"forms.userForm.sitePlaceholder")),n(2),d("ngForOf",a.siteOptions),n(),d("ngIf",a.isFieldInvalid("siteId")),n(3),u("",c(58,80,"forms.userForm.department")," "),n(4),w("is-invalid",a.isFieldInvalid("departementId")),n(2),x(c(64,82,"forms.userForm.departmentPlaceholder")),n(2),d("ngForOf",a.departmentOptions),n(),d("ngIf",a.isFieldInvalid("departementId")),n(3),u("",c(70,84,"forms.userForm.status")," "),n(4),w("is-invalid",a.isFieldInvalid("statut")),n(),d("ngForOf",a.statusOptions),n(),d("ngIf",a.isFieldInvalid("statut")),n(3),u("",c(79,86,"forms.userForm.language")," "),n(6),x(c(85,88,"forms.userForm.languages.fr")),n(3),x(c(88,90,"forms.userForm.languages.en")),n(3),x(c(91,92,"forms.userForm.languages.es")),n(4),x(c(95,94,"forms.userForm.address")),n(2),d("placeholder",U(c(97,96,"forms.userForm.addressPlaceholder"))),n(8),d("disabled",a.loading),n(2),u(" ",c(107,98,"forms.userForm.cancel")," "),n(2),d("disabled",a.userForm.invalid||a.loading),n(),d("ngIf",a.loading),n(),d("ngIf",!a.loading),n(),u(" ",a.loading?c(112,100,"forms.userForm.saving"):a.isEditMode?c(113,102,"forms.userForm.edit"):c(114,104,"forms.userForm.create")," "),n(8),u(" ",c(120,106,"forms.userForm.requiredField")," "))},dependencies:[O,P,D,Se,Ce,N,k,ve,we,Ee,Oe,Te,De,Me,Pe,H,Ve,A],styles:[".user-form[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;padding:24px;box-shadow:0 2px 10px #0000001a}.form-header[_ngcontent-%COMP%]{margin-bottom:24px;padding-bottom:16px;border-bottom:1px solid #eaeaea}.form-title[_ngcontent-%COMP%]{color:#333;font-size:1.5rem;font-weight:600;margin-bottom:8px}.form-description[_ngcontent-%COMP%]{color:#666;font-size:.95rem;margin-bottom:0}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}.form-column[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#555;margin-bottom:6px;font-size:.9rem}.form-label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc3545;margin-left:2px}.form-control[_ngcontent-%COMP%]{border:1px solid #ddd;border-radius:6px;padding:10px 12px;font-size:.95rem;transition:all .2s ease;background-color:#fff;width:100%}.form-control[_ngcontent-%COMP%]:focus{border-color:#4a90e2;box-shadow:0 0 0 .2rem #4a90e240;outline:none}.form-control.is-invalid[_ngcontent-%COMP%]{border-color:#dc3545}.form-control.is-invalid[_ngcontent-%COMP%]:focus{box-shadow:0 0 0 .2rem #dc354540}textarea.form-control[_ngcontent-%COMP%]{min-height:80px;resize:vertical}.invalid-feedback[_ngcontent-%COMP%]{font-size:.85rem;margin-top:4px;color:#dc3545}mat-form-field[_ngcontent-%COMP%]{width:100%}mat-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-subscript-wrapper[_ngcontent-%COMP%]{display:none}mat-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-infix[_ngcontent-%COMP%]{min-height:48px;padding-top:8px;padding-bottom:8px}mat-form-field[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-radius:6px;background-color:#fff}mat-form-field[_ngcontent-%COMP%]   .mat-mdc-form-field-flex[_ngcontent-%COMP%]{align-items:center}mat-form-field[_ngcontent-%COMP%]   .mat-mdc-select-value[_ngcontent-%COMP%]{font-size:.95rem}.mat-mdc-form-field.mat-form-field-invalid[_ngcontent-%COMP%]   .mat-mdc-text-field-wrapper[_ngcontent-%COMP%]{border-color:#dc3545}.mat-mdc-form-field-error[_ngcontent-%COMP%]{font-size:.85rem;color:#dc3545;margin-top:4px}.mat-mdc-option[_ngcontent-%COMP%]{font-size:.95rem}.mat-mdc-option[_ngcontent-%COMP%]:hover{background-color:#4a90e21a}.mat-mdc-select-panel[_ngcontent-%COMP%]{border-radius:6px;box-shadow:0 4px 12px #00000026}.alert[_ngcontent-%COMP%]{border-radius:6px;padding:12px 16px;margin-bottom:20px;border:none}.alert.alert-success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.alert.alert-danger[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.btn-close[_ngcontent-%COMP%]{opacity:.7}.btn-close[_ngcontent-%COMP%]:hover{opacity:1}.form-actions[_ngcontent-%COMP%]{padding-top:20px;border-top:1px solid #eaeaea;margin-top:24px}.spinner-border-sm[_ngcontent-%COMP%]{width:1rem;height:1rem;border-width:.2em}.form-help[_ngcontent-%COMP%]{margin-top:16px;text-align:center}.help-text[_ngcontent-%COMP%]{color:#6c757d;font-size:.85rem;margin-bottom:0}.help-text[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc3545}@media (max-width: 768px){.user-form[_ngcontent-%COMP%]{padding:16px}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:16px}.form-title[_ngcontent-%COMP%]{font-size:1.3rem}.btn[_ngcontent-%COMP%]{padding:8px 16px;font-size:.9rem}.action-buttons[_ngcontent-%COMP%]{flex-direction:column}.action-buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.form-control[_ngcontent-%COMP%], mat-form-field[_ngcontent-%COMP%], .alert[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}"]})};var at=["userFormModal"],ot=()=>({standalone:!0}),st=(s,t)=>t.id;function lt(s,t){s&1&&(r(0,"li")(1,"a",43),h(2,"i",44),o(3,"Chargement... "),i()())}function mt(s,t){if(s&1){let e=b();r(0,"li")(1,"a",8),f("click",function(){let l=_(e).$implicit,m=g();return v(m.filterBySite(l.id))}),o(2),i()()}if(s&2){let e=t.$implicit;n(2),u(" ",e.nom," ")}}function dt(s,t){s&1&&(r(0,"li")(1,"a",43),h(2,"i",44),o(3,"Chargement... "),i()())}function pt(s,t){if(s&1){let e=b();r(0,"li")(1,"a",8),f("click",function(){let l=_(e).$implicit,m=g();return v(m.filterByDepartment(l.id))}),o(2),i()()}if(s&2){let e=t.$implicit;n(2),u(" ",e.nom," ")}}function ct(s,t){s&1&&(r(0,"div",45)(1,"div",46)(2,"span",47),o(3,"Chargement..."),i()(),r(4,"p",48),o(5,"Chargement des utilisateurs..."),i()())}function ut(s,t){if(s&1){let e=b();r(0,"div",49),h(1,"i",50),o(2),r(3,"button",51),f("click",function(){_(e);let l=g();return v(l.error=null)}),i()()}if(s&2){let e=g();n(2),u(" ",e.error," ")}}function ft(s,t){if(s&1){let e=b();r(0,"li")(1,"a",73),f("click",function(){_(e);let l=g().$implicit,m=g(2);return v(m.deactivateUser(l))}),h(2,"i",74),o(3,"D\xE9sactiver "),i()()}}function gt(s,t){if(s&1){let e=b();r(0,"li")(1,"a",75),f("click",function(){_(e);let l=g().$implicit,m=g(2);return v(m.activateUser(l))}),h(2,"i",76),o(3,"Activer "),i()()}}function _t(s,t){if(s&1){let e=b();r(0,"tr")(1,"td")(2,"div",57)(3,"div",58),h(4,"img",59),i(),r(5,"div")(6,"h6",60),o(7),i(),r(8,"small",61),o(9),i()()()(),r(10,"td")(11,"a",62),o(12),i(),r(13,"button",63),f("click",function(){let l=_(e).$implicit,m=g(2);return v(m.copyEmail(l))}),h(14,"i",64),i()(),r(15,"td"),o(16),i(),r(17,"td"),o(18),i(),r(19,"td"),o(20),i(),r(21,"td"),o(22),i(),r(23,"td"),o(24),i(),r(25,"td")(26,"span",65),o(27),i()(),r(28,"td",55)(29,"div",4)(30,"a",66),h(31,"i",67),i(),r(32,"ul",25)(33,"li")(34,"a",68),f("click",function(){let l=_(e).$implicit,m=g(2);return v(m.viewUserDetails(l))}),h(35,"i",69),o(36,"Voir d\xE9tails "),i()(),r(37,"li")(38,"a",68),f("click",function(){let l=_(e).$implicit,m=g(2);return v(m.openEditUserModal(l))}),h(39,"i",70),o(40,"Modifier "),i()(),C(41,ft,4,0,"li",28)(42,gt,4,0,"li",28),r(43,"li")(44,"a",71),f("click",function(){let l=_(e).$implicit,m=g(2);return v(m.deleteUser(l))}),h(45,"i",72),o(46,"Supprimer "),i()()()()()()}if(s&2){let e=t.$implicit,a=g(2);n(4),d("src",e.photo||"assets/img/profiles/avatar-01.jpg",q),n(3),x(e.nomPrenom),n(2),x(e.userName),n(2),d("href",ce("mailto:",e.email),q),n(),x(e.email),n(4),x(e.telephone||"Non renseign\xE9"),n(2),x(e.siteNom||"Site "+e.siteId),n(2),x(e.departementNom||"D\xE9partement "+e.departementId),n(2),x(e.derniereConnexion?a.formatDate(e.derniereConnexion):"Jamais"),n(2),x(a.formatDate(e.dateCreation)),n(2),d("ngClass",a.getStatusClass(e.statut)),n(),u(" ",a.getStatusText(e.statut)," "),n(14),d("ngIf",e.statut==="ACTIF"),n(),d("ngIf",e.statut==="INACTIF"||e.statut==="EN_ATTENTE")}}function vt(s,t){s&1&&(r(0,"tr")(1,"td",77)(2,"div",78),h(3,"i",79),r(4,"h6",80),o(5,"Aucun utilisateur trouv\xE9"),i(),r(6,"p",81),o(7,"Aucun utilisateur ne correspond \xE0 vos crit\xE8res de recherche."),i()()()())}function ht(s,t){if(s&1){let e=b();r(0,"li",83)(1,"a",84),f("click",function(){let l=_(e).$implicit,m=g(3);return v(m.changePage(l))}),o(2),i()()}if(s&2){let e=t.$implicit,a=g(3);w("active",e===a.currentPage),n(2),u(" ",e+1," ")}}function xt(s,t){if(s&1){let e=b();r(0,"div",56)(1,"div",61),o(2),i(),r(3,"nav")(4,"ul",82)(5,"li",83)(6,"a",84),f("click",function(){_(e);let l=g(2);return v(l.changePage(l.currentPage-1))}),h(7,"i",85),i()(),Y(8,ht,3,3,"li",86,re),r(10,"li",83)(11,"a",84),f("click",function(){_(e);let l=g(2);return v(l.changePage(l.currentPage+1))}),h(12,"i",87),i()()()(),r(13,"div",4)(14,"a",88),o(15),i(),r(16,"ul",7)(17,"li")(18,"a",8),f("click",function(){_(e);let l=g(2);return v(l.changePageSize(5))}),o(19,"5 par page"),i()(),r(20,"li")(21,"a",8),f("click",function(){_(e);let l=g(2);return v(l.changePageSize(10))}),o(22,"10 par page"),i()(),r(23,"li")(24,"a",8),f("click",function(){_(e);let l=g(2);return v(l.changePageSize(25))}),o(25,"25 par page"),i()(),r(26,"li")(27,"a",8),f("click",function(){_(e);let l=g(2);return v(l.changePageSize(50))}),o(28,"50 par page"),i()()()()()}if(s&2){let e=g(2);n(2),le(" Affichage de ",e.users.length," utilisateur(s) sur ",e.totalElements," "),n(3),w("disabled",e.currentPage===0),n(3),W(e.getPageNumbers()),n(2),w("disabled",e.currentPage===e.totalPages-1),n(5),u(" ",e.pageSize," par page ")}}function Ct(s,t){if(s&1&&(r(0,"div",52)(1,"table",53)(2,"thead",54)(3,"tr")(4,"th"),o(5,"Utilisateur"),i(),r(6,"th"),o(7,"Email"),i(),r(8,"th"),o(9,"T\xE9l\xE9phone"),i(),r(10,"th"),o(11,"Site"),i(),r(12,"th"),o(13,"D\xE9partement"),i(),r(14,"th"),o(15,"Derni\xE8re connexion"),i(),r(16,"th"),o(17,"Date de cr\xE9ation"),i(),r(18,"th"),o(19,"Statut"),i(),r(20,"th",55),o(21,"Actions"),i()()(),r(22,"tbody"),Y(23,_t,47,15,"tr",null,st,!1,vt,8,0,"tr"),i()(),te(26,xt,29,7,"div",56),i()),s&2){let e=g();n(23),W(e.users),n(3),ie(e.totalPages>1?26:-1)}}function wt(s,t){s&1&&h(0,"div",89),s&2&&w("show",!1)}var ke=class s{getUsersUseCase=I(Fe);createUserUseCase=I(M);siteService=I(R);departementService=I(B);authService=I(V);userFormModal;users=[];loading=!1;error=null;selectedUser=null;isEditMode=!1;modalTitle="Cr\xE9er un nouvel utilisateur";currentPage=0;pageSize=10;totalElements=0;totalPages=0;searchQuery="";statusFilter="";siteFilter=null;departmentFilter=null;sites=[];departments=[];loadingFilters=!1;constructor(){}ngOnInit(){this.loadUsers(),this.loadFiltersData()}loadUsers(){return S(this,null,function*(){this.loading=!0,this.error=null;try{let t={page:this.currentPage,size:this.pageSize,search:this.searchQuery||void 0,sortBy:"nomPrenom",sortOrder:"asc"},e;this.siteFilter?e=yield this.getUsersUseCase.executeBySite(this.siteFilter,t):this.departmentFilter?e=yield this.getUsersUseCase.executeByDepartment(this.departmentFilter,t):e=yield this.getUsersUseCase.execute(t),this.users=e.content,this.totalElements=e.totalElements,this.totalPages=e.totalPages}catch(t){console.error("Erreur lors du chargement des utilisateurs:",t),this.error="Impossible de charger la liste des utilisateurs. Veuillez r\xE9essayer.",this.users=[]}finally{this.loading=!1}})}loadFiltersData(){return S(this,null,function*(){this.loadingFilters=!0;try{let e=this.authService.user?.societeId;if(!e){console.warn("Aucune soci\xE9t\xE9 trouv\xE9e pour l'utilisateur connect\xE9"),this.sites=[],this.departments=[];return}let a=yield this.siteService.getSites({societeId:e,page:0,size:100,actif:!0}).toPromise();a?.content?this.sites=a.content.map(m=>({id:m.id,nom:m.nom||`Site ${m.id}`})):this.sites=[];let l=yield this.departementService.getDepartements(e,0,100,void 0,!0).toPromise();l?.content?this.departments=l.content.map(m=>({id:m.id,nom:m.nom||`D\xE9partement ${m.id}`})):this.departments=[]}catch(t){console.error("Erreur lors du chargement des filtres:",t),this.sites=[],this.departments=[]}finally{this.loadingFilters=!1}})}onSearch(){this.currentPage=0,this.loadUsers()}resetFilters(){this.searchQuery="",this.statusFilter="",this.siteFilter=null,this.departmentFilter=null,this.currentPage=0,this.loadUsers()}filterBySite(t){this.siteFilter=t,this.departmentFilter=null,this.currentPage=0,this.loadUsers()}filterByDepartment(t){this.departmentFilter=t,this.siteFilter=null,this.currentPage=0,this.loadUsers()}getSelectedSiteName(){if(!this.siteFilter)return"Tous";let t=this.sites.find(e=>e.id===this.siteFilter);return t?t.nom:`Site ${this.siteFilter}`}getSelectedDepartmentName(){if(!this.departmentFilter)return"Tous";let t=this.departments.find(e=>e.id===this.departmentFilter);return t?t.nom:`D\xE9partement ${this.departmentFilter}`}changePage(t){t>=0&&t<this.totalPages&&(this.currentPage=t,this.loadUsers())}changePageSize(t){this.pageSize=t,this.currentPage=0,this.loadUsers()}openCreateUserModal(){this.selectedUser=null,this.isEditMode=!1,this.modalTitle="Cr\xE9er un nouvel utilisateur",this.openModal()}openEditUserModal(t){this.selectedUser=t,this.isEditMode=!0,this.modalTitle=`Modifier l'utilisateur ${t.nomPrenom}`,this.openModal()}openModal(){let t=this.userFormModal?.nativeElement;t?new window.bootstrap.Modal(t).show():console.error("\xC9l\xE9ment modal non trouv\xE9")}activateUser(t){return S(this,null,function*(){try{console.log("Activer utilisateur:",t),yield this.loadUsers()}catch(e){console.error("Erreur lors de l'activation:",e),this.error="Impossible d'activer l'utilisateur."}})}deactivateUser(t){return S(this,null,function*(){try{console.log("D\xE9sactiver utilisateur:",t),yield this.loadUsers()}catch(e){console.error("Erreur lors de la d\xE9sactivation:",e),this.error="Impossible de d\xE9sactiver l'utilisateur."}})}deleteUser(t){return S(this,null,function*(){if(confirm(`\xCAtes-vous s\xFBr de vouloir supprimer l'utilisateur ${t.nomPrenom} ?`))try{console.log("Supprimer utilisateur:",t),yield this.loadUsers()}catch(e){console.error("Erreur lors de la suppression:",e),this.error="Impossible de supprimer l'utilisateur."}})}exportUsers(){console.log("Exporter la liste des utilisateurs"),alert("Fonctionnalit\xE9 d'exportation \xE0 impl\xE9menter")}importUsers(){console.log("Importer des utilisateurs"),alert("Fonctionnalit\xE9 d'importation \xE0 impl\xE9menter")}generateReport(){console.log("G\xE9n\xE9rer un rapport d'utilisateurs"),alert("Fonctionnalit\xE9 de rapport \xE0 impl\xE9menter")}viewUserDetails(t){console.log("Voir les d\xE9tails de:",t),alert(`D\xE9tails de l'utilisateur: ${t.nomPrenom}
Email: ${t.email}
Statut: ${t.statut}`)}copyEmail(t){navigator.clipboard.writeText(t.email).then(()=>{console.log("Email copi\xE9:",t.email),alert("Email copi\xE9 dans le presse-papier")}).catch(e=>{console.error("Erreur lors de la copie:",e),alert("Erreur lors de la copie de l'email")})}formatDate(t){try{let e=new Date(t);return isNaN(e.getTime())?"Date invalide":e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Date invalide"}}getStatusClass(t){switch(t){case"ACTIF":return"badge bg-success";case"INACTIF":return"badge bg-danger";case"EN_ATTENTE":return"badge bg-warning";default:return"badge bg-secondary"}}getStatusText(t){switch(t){case"ACTIF":return"Actif";case"INACTIF":return"Inactif";case"EN_ATTENTE":return"En attente";default:return t}}changeSort(t,e){console.log(`Trier par ${t} (${e})`),this.loadUsers()}filterByStatus(t){this.statusFilter=t,this.currentPage=0,this.loadUsers()}getPageNumbers(){let t=[],a=Math.max(0,this.currentPage-Math.floor(2.5)),l=Math.min(this.totalPages-1,a+5-1);l-a+1<5&&(a=Math.max(0,l-5+1));for(let m=a;m<=l;m++)t.push(m);return t}onUserSaved(t){console.log("Utilisateur sauvegard\xE9:",t),this.loadUsers(),this.closeModal()}onFormCancelled(){console.log("Formulaire annul\xE9"),this.closeModal()}closeModal(){let t=this.userFormModal?.nativeElement;if(t){let e=window.bootstrap.Modal.getInstance(t);e&&e.hide()}}static \u0275fac=function(e){return new(e||s)};static \u0275cmp=T({type:s,selectors:[["app-users"]],viewQuery:function(e,a){if(e&1&&ne(at,5),e&2){let l;ae(l=oe())&&(a.userFormModal=l.first)}},decls:122,vars:72,consts:[["userFormModal",""],[1,"content-two"],[1,"d-flex","d-block","align-items-center","justify-content-between","flex-wrap","gap-3","mb-3"],[1,"d-flex","my-xl-auto","right-content","align-items-center","flex-wrap","gap-2"],[1,"dropdown"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-outline-white","d-inline-flex","align-items-center"],[1,"isax","isax-export-1","me-1"],[1,"dropdown-menu"],["href","javascript:void(0);",1,"dropdown-item",3,"click"],["href","javascript:void(0);",1,"btn","btn-primary","d-flex","align-items-center",3,"click"],[1,"isax","isax-add-circle5","me-1"],[1,"mb-3"],[1,"d-flex","align-items-center","justify-content-between","flex-wrap","gap-3"],[1,"d-flex","align-items-center","flex-wrap","gap-2"],[1,"table-search","d-flex","align-items-center","mb-0"],[1,"search-input"],["href","javascript:void(0);",1,"btn-searchset"],[1,"isax","isax-search-normal","fs-12"],["id","DataTables_Table_0_filter",1,"dataTables_filter"],["type","search","aria-controls","DataTables_Table_0",1,"form-control","form-control-sm",3,"ngModelChange","ngModel","ngModelOptions","placeholder"],["href","javascript:void(0);",1,"btn","btn-outline-white","fw-normal","d-inline-flex","align-items-center",3,"click"],[1,"isax","isax-refresh","me-1"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"dropdown-toggle","btn","btn-outline-white","d-inline-flex","align-items-center"],[1,"isax","isax-sort","me-1"],[1,"fw-normal","ms-1"],[1,"dropdown-menu","dropdown-menu-end"],[1,"isax","isax-filter","me-1"],[1,"isax","isax-building","me-1"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"isax","isax-building-3","me-1"],["class","text-center py-4",4,"ngIf"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["class","table-responsive",4,"ngIf"],["tabindex","-1",1,"modal","fade"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[3,"userSaved","cancelled","user","isEditMode"],["class","modal-backdrop fade",3,"show",4,"ngIf"],["href","javascript:void(0);",1,"dropdown-item","disabled"],[1,"fas","fa-spinner","fa-spin","me-2"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],[1,"fas","fa-exclamation-circle","me-2"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"table-responsive"],[1,"table","table-nowrap","dataTable","datatable"],[1,"thead-light"],[1,"text-end"],[1,"d-flex","justify-content-between","align-items-center","mt-3"],[1,"d-flex","align-items-center"],[1,"avatar","avatar-sm","rounded-circle","me-2","flex-shrink-0"],["alt","Avatar",1,"rounded-circle",3,"src"],[1,"fs-14","fw-medium","mb-0"],[1,"text-muted"],[1,"text-primary",3,"href"],["title","Copier l'email",1,"btn","btn-sm","btn-link","text-muted","p-0","ms-1",3,"click"],[1,"fas","fa-copy"],[1,"badge","d-inline-flex","align-items-center",3,"ngClass"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-sm","btn-outline-white"],[1,"isax","isax-more"],["href","javascript:void(0);",1,"dropdown-item","d-flex","align-items-center",3,"click"],[1,"isax","isax-eye","me-2"],[1,"isax","isax-edit","me-2"],["href","javascript:void(0);",1,"dropdown-item","d-flex","align-items-center","text-danger",3,"click"],[1,"isax","isax-trash","me-2"],["href","javascript:void(0);",1,"dropdown-item","d-flex","align-items-center","text-warning",3,"click"],[1,"isax","isax-pause-circle","me-2"],["href","javascript:void(0);",1,"dropdown-item","d-flex","align-items-center","text-success",3,"click"],[1,"isax","isax-play-circle","me-2"],["colspan","9",1,"text-center","py-4"],[1,"empty-state"],[1,"isax","isax-user-square","fs-48","text-muted","mb-3"],[1,"mb-2"],[1,"text-muted","mb-0"],[1,"pagination","pagination-sm","mb-0"],[1,"page-item"],["href","javascript:void(0);",1,"page-link",3,"click"],[1,"fas","fa-chevron-left"],[1,"page-item",3,"active"],[1,"fas","fa-chevron-right"],["href","javascript:void(0);","data-bs-toggle","dropdown",1,"btn","btn-outline-white","btn-sm","dropdown-toggle"],[1,"modal-backdrop","fade"]],template:function(e,a){if(e&1){let l=b();r(0,"div",1)(1,"div",2)(2,"div")(3,"h6"),o(4),p(5,"translate"),i()(),r(6,"div",3)(7,"div",4)(8,"a",5),h(9,"i",6),o(10),p(11,"translate"),i(),r(12,"ul",7)(13,"li")(14,"a",8),f("click",function(){return _(l),v(a.exportUsers())}),o(15),p(16,"translate"),i()(),r(17,"li")(18,"a",8),f("click",function(){return _(l),v(a.exportUsers())}),o(19),p(20,"translate"),i()()()(),r(21,"div")(22,"a",9),f("click",function(){return _(l),v(a.openCreateUserModal())}),h(23,"i",10),o(24),p(25,"translate"),i()()()(),r(26,"div",11)(27,"div",12)(28,"div",13)(29,"div",14)(30,"div",15)(31,"a",16),h(32,"i",17),i(),r(33,"div",18)(34,"label")(35,"input",19),p(36,"translate"),pe("ngModelChange",function(F){return _(l),de(a.searchQuery,F)||(a.searchQuery=F),v(F)}),f("ngModelChange",function(){return _(l),v(a.onSearch())}),i()()()()(),r(37,"a",20),f("click",function(){return _(l),v(a.resetFilters())}),h(38,"i",21),o(39),p(40,"translate"),i()(),r(41,"div",13)(42,"div",4)(43,"a",22),h(44,"i",23),o(45),p(46,"translate"),r(47,"span",24),o(48,"Nom"),i()(),r(49,"ul",25)(50,"li")(51,"a",8),f("click",function(){return _(l),v(a.changeSort("nomPrenom","asc"))}),o(52),p(53,"translate"),i()(),r(54,"li")(55,"a",8),f("click",function(){return _(l),v(a.changeSort("nomPrenom","desc"))}),o(56),p(57,"translate"),i()(),r(58,"li")(59,"a",8),f("click",function(){return _(l),v(a.changeSort("dateCreation","desc"))}),o(60),p(61,"translate"),i()(),r(62,"li")(63,"a",8),f("click",function(){return _(l),v(a.changeSort("dateCreation","asc"))}),o(64),p(65,"translate"),i()()()(),r(66,"div",4)(67,"a",22),h(68,"i",26),o(69),p(70,"translate"),i(),r(71,"ul",7)(72,"li")(73,"a",8),f("click",function(){return _(l),v(a.filterByStatus(""))}),o(74),p(75,"translate"),i()(),r(76,"li")(77,"a",8),f("click",function(){return _(l),v(a.filterByStatus("ACTIF"))}),o(78),p(79,"translate"),i()(),r(80,"li")(81,"a",8),f("click",function(){return _(l),v(a.filterByStatus("INACTIF"))}),o(82),p(83,"translate"),i()(),r(84,"li")(85,"a",8),f("click",function(){return _(l),v(a.filterByStatus("EN_ATTENTE"))}),o(86),p(87,"translate"),i()()()(),r(88,"div",4)(89,"a",22),h(90,"i",27),o(91),i(),r(92,"ul",7)(93,"li")(94,"a",8),f("click",function(){return _(l),v(a.filterBySite(null))}),o(95," Tous les sites "),i()(),C(96,lt,4,0,"li",28)(97,mt,3,1,"li",29),i()(),r(98,"div",4)(99,"a",22),h(100,"i",30),o(101),i(),r(102,"ul",7)(103,"li")(104,"a",8),f("click",function(){return _(l),v(a.filterByDepartment(null))}),o(105," Tous les d\xE9partements "),i()(),C(106,dt,4,0,"li",28)(107,pt,3,1,"li",29),i()()()()(),C(108,ct,6,0,"div",31)(109,ut,4,1,"div",32)(110,Ct,27,2,"div",33),i(),r(111,"div",34,0)(113,"div",35)(114,"div",36)(115,"div",37)(116,"h5",38),o(117),i(),r(118,"button",39),f("click",function(){return _(l),v(a.onFormCancelled())}),i()(),r(119,"div",40)(120,"app-user-form",41),f("userSaved",function(F){return _(l),v(a.onUserSaved(F))})("cancelled",function(){return _(l),v(a.onFormCancelled())}),i()()()()(),C(121,wt,1,2,"div",42)}e&2&&(n(4),x(c(5,37,"manageUsers.title")),n(6),u("",c(11,39,"manageUsers.export")," "),n(5),x(c(16,41,"manageUsers.exportPdf")),n(4),x(c(20,43,"manageUsers.exportExcel")),n(5),u("",c(25,45,"manageUsers.newUser")," "),n(11),d("placeholder",U(c(36,47,"manageUsers.search"))),me("ngModel",a.searchQuery),d("ngModelOptions",fe(71,ot)),n(4),u("",c(40,49,"manageUsers.reset")," "),n(6),u("",c(46,51,"manageUsers.sortBy")," "),n(7),x(c(53,53,"manageUsers.sortNameAsc")),n(4),x(c(57,55,"manageUsers.sortNameDesc")),n(4),x(c(61,57,"manageUsers.sortRecent")),n(4),x(c(65,59,"manageUsers.sortOldest")),n(5),u("",c(70,61,"manageUsers.filterStatus")," "),n(5),x(c(75,63,"manageUsers.filterAll")),n(4),x(c(79,65,"manageUsers.filterActive")),n(4),x(c(83,67,"manageUsers.filterInactive")),n(4),x(c(87,69,"manageUsers.filterPending")),n(5),u(" Site: ",a.getSelectedSiteName()," "),n(5),d("ngIf",a.loadingFilters),n(),d("ngForOf",a.sites),n(4),u(" D\xE9partement: ",a.getSelectedDepartmentName()," "),n(5),d("ngIf",a.loadingFilters),n(),d("ngForOf",a.departments),n(),d("ngIf",a.loading),n(),d("ngIf",a.error&&!a.loading),n(),d("ngIf",!a.loading&&!a.error),n(),se("display","none"),w("show",!1),n(6),u(" ",a.modalTitle," "),n(3),d("user",a.selectedUser||void 0)("isEditMode",a.isEditMode),n(),d("ngIf",!1))},dependencies:[O,ge,P,D,be,N,k,xe,_e,L,A],encapsulation:2})};export{ke as UsersComponent};
