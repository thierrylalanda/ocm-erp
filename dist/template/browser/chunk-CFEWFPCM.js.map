{
  "version": 3,
  "sources": ["src/app/modules/setting/application/services/departement.service.ts"],
  "sourcesContent": ["import { Injectable } from '@angular/core';\nimport { HttpClient, HttpParams, HttpErrorResponse } from '@angular/common/http';\nimport { Observable, throwError, of } from 'rxjs';\nimport { catchError, map } from 'rxjs/operators';\nimport { environment } from '../../../../../environments/environment';\nimport { \n  CreateDepartementDto, \n  UpdateDepartementDto, \n  DepartementResponseDto, \n  PagedDepartementResponse,\n  DepartementStatistics \n} from '../../domain/dto/departement.dto';\nimport { AuthService } from '../../../../core/services/auth/auth.service';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class DepartementService {\n  private apiUrl = `${environment.api}hierarchie/departements`;\n\n  constructor(private http: HttpClient,private authService: AuthService) {}\n\n  /**\n   * Récupère la liste paginée des départements\n   * @param societeId ID de la société (optionnel)\n   * @param page Numéro de page (0-based)\n   * @param size Taille de la page\n   * @param search Terme de recherche\n   * @param actif Filtre par statut\n   */\n  getDepartements(\n    societeId?: number,\n    page: number = 0,\n    size: number = 10,\n    search?: string,\n    actif?: boolean\n  ): Observable<PagedDepartementResponse> {\n    let params = new HttpParams()\n      .set('page', page.toString())\n      .set('size', size.toString());\n\n    if (societeId) {\n      params = params.set('societeId', societeId.toString());\n    }\n\n    if (search) {\n      params = params.set('search', search);\n    }\n\n    if (actif !== undefined) {\n      params = params.set('actif', actif.toString());\n    }\n\n    return this.http.get<PagedDepartementResponse>(this.apiUrl, { params });\n  }\n\n  /**\n   * Récupère un département par son ID\n   * @param id ID du département\n   */\n  getDepartement(id: number): Observable<DepartementResponseDto> {\n    return this.http.get<DepartementResponseDto>(`${this.apiUrl}/${id}`);\n  }\n\n  /**\n   * Crée un nouveau département\n   * @param dto Données du département\n   */\n  createDepartement(dto: CreateDepartementDto): Observable<DepartementResponseDto> {\n    return this.http.post<DepartementResponseDto>(this.apiUrl, dto);\n  }\n\n  /**\n   * Met à jour un département existant\n   * @param id ID du département\n   * @param dto Données mises à jour\n   */\n  updateDepartement(id: number, dto: UpdateDepartementDto): Observable<DepartementResponseDto> {\n    return this.http.put<DepartementResponseDto>(`${this.apiUrl}/${id}`, dto);\n  }\n\n  /**\n   * Supprime un département\n   * @param id ID du département\n   */\n  deleteDepartement(id: number): Observable<void> {\n    return this.http.delete<void>(`${this.apiUrl}/${id}`);\n  }\n\n  /**\n   * Active ou désactive un département\n   * @param id ID du département\n   * @param actif Nouveau statut\n   */\n  toggleDepartementStatus(id: number, actif: boolean): Observable<DepartementResponseDto> {\n    return this.http.patch<DepartementResponseDto>(`${this.apiUrl}/${id}/status`, { actif });\n  }\n\n  /**\n   * Récupère les statistiques des départements\n   * @param societeId ID de la société (optionnel)\n   */\n  getDepartementStatistics(societeId?: number): Observable<DepartementStatistics> {\n    let params = new HttpParams();\n    if (societeId) {\n      params = params.set('societeId', societeId.toString());\n    }\n    \n    return this.http.get<DepartementStatistics>(`${this.apiUrl}/statistics`, { params });\n  }\n\n  /**\n   * Récupère la liste de toutes les sociétés (pour les dropdowns)\n   * Note: Cette méthode dépend de l'API des sociétés\n   */\n  getSocietes(): Observable<any[]> {\n    // À adapter selon l'API des sociétés\n    return this.http.get<any[]>(`${environment.api}societes`);\n  }\n\n   /**\n   * Récupère la société de l'utilisateur connecté\n   */\n  getCurrentUserSocieteId(): number | null {\n    const user = this.authService.user;\n    return user?.societeId || null;\n  }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAiBM,IAAO,qBAAP,MAAO,oBAAkB;EAGT;EAAyB;EAFrC,SAAS,GAAG,YAAY,GAAG;EAEnC,YAAoB,MAAyB,aAAwB;AAAjD,SAAA,OAAA;AAAyB,SAAA,cAAA;EAA2B;;;;;;;;;EAUxE,gBACE,WACA,OAAe,GACf,OAAe,IACf,QACA,OAAe;AAEf,QAAI,SAAS,IAAI,WAAU,EACxB,IAAI,QAAQ,KAAK,SAAQ,CAAE,EAC3B,IAAI,QAAQ,KAAK,SAAQ,CAAE;AAE9B,QAAI,WAAW;AACb,eAAS,OAAO,IAAI,aAAa,UAAU,SAAQ,CAAE;IACvD;AAEA,QAAI,QAAQ;AACV,eAAS,OAAO,IAAI,UAAU,MAAM;IACtC;AAEA,QAAI,UAAU,QAAW;AACvB,eAAS,OAAO,IAAI,SAAS,MAAM,SAAQ,CAAE;IAC/C;AAEA,WAAO,KAAK,KAAK,IAA8B,KAAK,QAAQ,EAAE,OAAM,CAAE;EACxE;;;;;EAMA,eAAe,IAAU;AACvB,WAAO,KAAK,KAAK,IAA4B,GAAG,KAAK,MAAM,IAAI,EAAE,EAAE;EACrE;;;;;EAMA,kBAAkB,KAAyB;AACzC,WAAO,KAAK,KAAK,KAA6B,KAAK,QAAQ,GAAG;EAChE;;;;;;EAOA,kBAAkB,IAAY,KAAyB;AACrD,WAAO,KAAK,KAAK,IAA4B,GAAG,KAAK,MAAM,IAAI,EAAE,IAAI,GAAG;EAC1E;;;;;EAMA,kBAAkB,IAAU;AAC1B,WAAO,KAAK,KAAK,OAAa,GAAG,KAAK,MAAM,IAAI,EAAE,EAAE;EACtD;;;;;;EAOA,wBAAwB,IAAY,OAAc;AAChD,WAAO,KAAK,KAAK,MAA8B,GAAG,KAAK,MAAM,IAAI,EAAE,WAAW,EAAE,MAAK,CAAE;EACzF;;;;;EAMA,yBAAyB,WAAkB;AACzC,QAAI,SAAS,IAAI,WAAU;AAC3B,QAAI,WAAW;AACb,eAAS,OAAO,IAAI,aAAa,UAAU,SAAQ,CAAE;IACvD;AAEA,WAAO,KAAK,KAAK,IAA2B,GAAG,KAAK,MAAM,eAAe,EAAE,OAAM,CAAE;EACrF;;;;;EAMA,cAAW;AAET,WAAO,KAAK,KAAK,IAAW,GAAG,YAAY,GAAG,UAAU;EAC1D;;;;EAKA,0BAAuB;AACrB,UAAM,OAAO,KAAK,YAAY;AAC9B,WAAO,MAAM,aAAa;EAC5B;;qCA7GW,qBAAkB,mBAAA,UAAA,GAAA,mBAAA,WAAA,CAAA;EAAA;4EAAlB,qBAAkB,SAAlB,oBAAkB,WAAA,YAFjB,OAAM,CAAA;;;sEAEP,oBAAkB,CAAA;UAH9B;WAAW;MACV,YAAY;KACb;;;",
  "names": []
}
