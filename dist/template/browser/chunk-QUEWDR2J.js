import{a as A,e as g}from"./chunk-6ZIFMK4B.js";import{_c as U,f as T,ia as f,ja as _,la as l,ma as E,na as m,wb as y}from"./chunk-ODQYRIBQ.js";import{a as p,b as h,f as I}from"./chunk-EQDQRRRY.js";var D=new l("MAT_DATE_LOCALE",{providedIn:"root",factory:R});function R(){return m(U)}var o="Method not implemented",d=class{locale;_localeChanges=new T;localeChanges=this._localeChanges;setTime(t,e,r,n){throw new Error(o)}getHours(t){throw new Error(o)}getMinutes(t){throw new Error(o)}getSeconds(t){throw new Error(o)}parseTime(t,e){throw new Error(o)}addSeconds(t,e){throw new Error(o)}getValidDateOrNull(t){return this.isDateInstance(t)&&this.isValid(t)?t:null}deserialize(t){return t==null||this.isDateInstance(t)&&this.isValid(t)?t:this.invalid()}setLocale(t){this.locale=t,this._localeChanges.next()}compareDate(t,e){return this.getYear(t)-this.getYear(e)||this.getMonth(t)-this.getMonth(e)||this.getDate(t)-this.getDate(e)}compareTime(t,e){return this.getHours(t)-this.getHours(e)||this.getMinutes(t)-this.getMinutes(e)||this.getSeconds(t)-this.getSeconds(e)}sameDate(t,e){if(t&&e){let r=this.isValid(t),n=this.isValid(e);return r&&n?!this.compareDate(t,e):r==n}return t==e}sameTime(t,e){if(t&&e){let r=this.isValid(t),n=this.isValid(e);return r&&n?!this.compareTime(t,e):r==n}return t==e}clampDate(t,e,r){return e&&this.compareDate(t,e)<0?e:r&&this.compareDate(t,r)>0?r:t}},v=new l("mat-date-formats");var x=/^\d{4}-\d{2}-\d{2}(?:T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|(?:(?:\+|-)\d{2}:\d{2}))?)?$/,L=/^(\d?\d)[:.](\d?\d)(?:[:.](\d?\d))?\s*(AM|PM)?$/i;function M(i,t){let e=Array(i);for(let r=0;r<i;r++)e[r]=t(r);return e}var N=(()=>{class i extends d{useUtcForDisplay=!1;_matDateLocale=m(D,{optional:!0});constructor(){super();let e=m(D,{optional:!0});e!==void 0&&(this._matDateLocale=e),super.setLocale(this._matDateLocale)}getYear(e){return e.getFullYear()}getMonth(e){return e.getMonth()}getDate(e){return e.getDate()}getDayOfWeek(e){return e.getDay()}getMonthNames(e){let r=new Intl.DateTimeFormat(this.locale,{month:e,timeZone:"utc"});return M(12,n=>this._format(r,new Date(2017,n,1)))}getDateNames(){let e=new Intl.DateTimeFormat(this.locale,{day:"numeric",timeZone:"utc"});return M(31,r=>this._format(e,new Date(2017,0,r+1)))}getDayOfWeekNames(e){let r=new Intl.DateTimeFormat(this.locale,{weekday:e,timeZone:"utc"});return M(7,n=>this._format(r,new Date(2017,0,n+1)))}getYearName(e){let r=new Intl.DateTimeFormat(this.locale,{year:"numeric",timeZone:"utc"});return this._format(r,e)}getFirstDayOfWeek(){if(typeof Intl<"u"&&Intl.Locale){let e=new Intl.Locale(this.locale),r=(e.getWeekInfo?.()||e.weekInfo)?.firstDay??0;return r===7?0:r}return 0}getNumDaysInMonth(e){return this.getDate(this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+1,0))}clone(e){return new Date(e.getTime())}createDate(e,r,n){let a=this._createDateWithOverflow(e,r,n);return a.getMonth()!=r,a}today(){return new Date}parse(e,r){return typeof e=="number"?new Date(e):e?new Date(Date.parse(e)):null}format(e,r){if(!this.isValid(e))throw Error("NativeDateAdapter: Cannot format invalid date.");let n=new Intl.DateTimeFormat(this.locale,h(p({},r),{timeZone:"utc"}));return this._format(n,e)}addCalendarYears(e,r){return this.addCalendarMonths(e,r*12)}addCalendarMonths(e,r){let n=this._createDateWithOverflow(this.getYear(e),this.getMonth(e)+r,this.getDate(e));return this.getMonth(n)!=((this.getMonth(e)+r)%12+12)%12&&(n=this._createDateWithOverflow(this.getYear(n),this.getMonth(n),0)),n}addCalendarDays(e,r){return this._createDateWithOverflow(this.getYear(e),this.getMonth(e),this.getDate(e)+r)}toIso8601(e){return[e.getUTCFullYear(),this._2digit(e.getUTCMonth()+1),this._2digit(e.getUTCDate())].join("-")}deserialize(e){if(typeof e=="string"){if(!e)return null;if(x.test(e)){let r=new Date(e);if(this.isValid(r))return r}}return super.deserialize(e)}isDateInstance(e){return e instanceof Date}isValid(e){return!isNaN(e.getTime())}invalid(){return new Date(NaN)}setTime(e,r,n,a){let s=this.clone(e);return s.setHours(r,n,a,0),s}getHours(e){return e.getHours()}getMinutes(e){return e.getMinutes()}getSeconds(e){return e.getSeconds()}parseTime(e,r){if(typeof e!="string")return e instanceof Date?new Date(e.getTime()):null;let n=e.trim();if(n.length===0)return null;let a=this._parseTimeString(n);if(a===null){let s=n.replace(/[^0-9:(AM|PM)]/gi,"").trim();s.length>0&&(a=this._parseTimeString(s))}return a||this.invalid()}addSeconds(e,r){return new Date(e.getTime()+r*1e3)}_createDateWithOverflow(e,r,n){let a=new Date;return a.setFullYear(e,r,n),a.setHours(0,0,0,0),a}_2digit(e){return("00"+e).slice(-2)}_format(e,r){let n=new Date;return n.setUTCFullYear(r.getFullYear(),r.getMonth(),r.getDate()),n.setUTCHours(r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),e.format(n)}_parseTimeString(e){let r=e.toUpperCase().match(L);if(r){let n=parseInt(r[1]),a=parseInt(r[2]),s=r[3]==null?void 0:parseInt(r[3]),c=r[4];if(n===12?n=c==="AM"?0:n:c==="PM"&&(n+=12),w(n,0,23)&&w(a,0,59)&&(s==null||w(s,0,59)))return this.setTime(this.today(),n,a,s||0)}return null}static \u0275fac=function(r){return new(r||i)};static \u0275prov=f({token:i,factory:i.\u0275fac})}return i})();function w(i,t,e){return!isNaN(i)&&i>=t&&i<=e}var S={parse:{dateInput:null,timeInput:null},display:{dateInput:{year:"numeric",month:"numeric",day:"numeric"},timeInput:{hour:"numeric",minute:"numeric"},monthYearLabel:{year:"numeric",month:"short"},dateA11yLabel:{year:"numeric",month:"long",day:"numeric"},monthYearA11yLabel:{year:"numeric",month:"long"},timeOptionLabel:{hour:"numeric",minute:"numeric"}}};var q=(()=>{class i{static \u0275fac=function(r){return new(r||i)};static \u0275mod=y({type:i});static \u0275inj=_({providers:[b()]})}return i})();function b(i=S){return[{provide:d,useClass:N},{provide:v,useValue:i}]}var X=new l("UpdateUserUseCase");var C=class i{constructor(t){this.userRepository=t}execute(t,e){return I(this,null,function*(){this.validateUpdateUserDto(e);let r={value:t},n=yield this.userRepository.findById(r);if(!n)throw new Error(`L'utilisateur avec l'ID ${t} n'existe pas`);if(e.email!==n.email){let u=yield this.userRepository.findByEmail(e.email);if(u&&u.id!==t)throw new Error(`Un autre utilisateur avec l'email ${e.email} existe d\xE9j\xE0`)}if(e.userName!==n.userName){let u=yield this.userRepository.findByUsername(e.userName);if(u&&u.id!==t)throw new Error(`Un autre utilisateur avec le nom d'utilisateur ${e.userName} existe d\xE9j\xE0`)}let a=g.toUpdateCommand(e),s=h(p({},n),{societeId:a.societeId??n.societeId,nomPrenom:a.nomPrenom??n.nomPrenom,telephone:a.telephone??n.telephone,adresse:a.adresse??n.adresse,userName:a.userName??n.userName,email:a.email??n.email,statut:a.statut??n.statut,siteId:a.siteId??n.siteId,departementId:a.departementId??n.departementId,photo:a.photo??n.photo,signature:a.signature??n.signature,langue:a.langue??n.langue}),c=yield this.userRepository.update(s);return g.toResponseDto(c)})}validateUpdateUserDto(t){let e=[];if((!t.nomPrenom||t.nomPrenom.trim().length===0)&&e.push("Le nom et pr\xE9nom sont requis"),(!t.userName||t.userName.trim().length===0)&&e.push("Le nom d'utilisateur est requis"),(!t.email||!this.isValidEmail(t.email))&&e.push("Un email valide est requis"),t.password&&t.password.trim().length>0&&t.password.trim().length<6&&e.push("Le mot de passe doit contenir au moins 6 caract\xE8res"),t.pwdText&&(!t.pwdText||t.pwdText.trim().length===0)&&e.push("Le texte du mot de passe est requis"),(!t.societeId||t.societeId<=0)&&e.push("Un identifiant de soci\xE9t\xE9 valide est requis"),(!t.siteId||t.siteId<=0)&&e.push("Un identifiant de site valide est requis"),(!t.departementId||t.departementId<=0)&&e.push("Un identifiant de d\xE9partement valide est requis"),t.statut||e.push("Le statut est requis"),e.length>0)throw new Error(`Validation \xE9chou\xE9e: ${e.join(", ")}`)}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}isValidPhoneNumber(t){return/^[\d\s\-\+\(\)]{8,20}$/.test(t)}static \u0275fac=function(e){return new(e||i)(E(A))};static \u0275prov=f({token:i,factory:i.\u0275fac})};export{d as a,v as b,q as c,X as d,C as e};
