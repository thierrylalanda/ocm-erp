<div class="header">
	<div class="main-header">

		<!-- Logo -->
		<div class="header-left">
			<a [routerLink]="routes.index" class="logo">
				<img src="assets/img/logo.svg" alt="Logo">
			</a>
			<a [routerLink]="routes.index" class="dark-logo">
				<img src="assets/img/logo-white.svg" alt="Logo">
			</a>
		</div>

		<!-- Sidebar Menu Toggle Button -->
		<a id="mobile_btn" class="mobile_btn" href="javascript:void(0);" (click)="toggleMobileIcon()">
			<span class="bar-icon">
				<span></span>
				<span></span>
				<span></span>
			</span>
		</a>

		<div class="header-user">
			<div class="nav user-menu nav-list">
				<div class="me-auto d-flex align-items-center" id="header-search">

					<!-- Add -->
					<div class="dropdown me-3">
						<a class="btn btn-primary bg-gradient btn-xs btn-icon rounded-circle d-flex align-items-center justify-content-center"
							data-bs-toggle="dropdown" href="javascript:void(0);" role="button">
							<i class="isax isax-add text-white"></i>
						</a>
						<ul class="dropdown-menu dropdown-menu-start p-2">
							<li>
								<a [routerLink]="routes.addInvoice" class="dropdown-item d-flex align-items-center">
									<i class="isax isax-document-text-1 me-2"></i>Invoice
								</a>
							</li>
							<li>
								<a [routerLink]="routes.expenses" class="dropdown-item d-flex align-items-center">
									<i class="isax isax-money-send me-2"></i>Expense
								</a>
							</li>
							<li>
								<a [routerLink]="routes.addCreditNotes" class="dropdown-item d-flex align-items-center">
									<i class="isax isax-money-add me-2"></i>Credit Notes
								</a>
							</li>
							<li>
								<a [routerLink]="routes.addDebitNotes" class="dropdown-item d-flex align-items-center">
									<i class="isax isax-money-recive me-2"></i>Debit Notes
								</a>
							</li>
							<li>
								<a [routerLink]="routes.addPurchaseOrder"
									class="dropdown-item d-flex align-items-center">
									<i class="isax isax-document me-2"></i>Purchase Order
								</a>
							</li>
							<li>
								<a [routerLink]="routes.addQuotations" class="dropdown-item d-flex align-items-center">
									<i class="isax isax-document-download me-2"></i>Quotation
								</a>
							</li>
							<li>
								<a [routerLink]="routes.addDeliveryChallan"
									class="dropdown-item d-flex align-items-center">
									<i class="isax isax-document-forward me-2"></i>Delivery Challan
								</a>
							</li>
						</ul>
					</div>

					<!-- Breadcrumb -->
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb breadcrumb-divide mb-0">
							<li class="breadcrumb-item d-flex align-items-center">
								<a [routerLink]="routes.index">
									<i class="isax isax-home-2 me-1"></i>Home
								</a>
							</li>
							<ng-container *ngFor="let mainMenus of bread_Crumb">
								<li *ngIf="!mainMenus.hasSubData && (base === mainMenus.base || page === mainMenus.base)"
									class="breadcrumb-item active" aria-current="page">
									{{ mainMenus.data }}
								</li>
								<ng-container
									*ngIf="mainMenus.hasSubData && (page === mainMenus.page || last === mainMenus.page)">
									<li class="breadcrumb-item d-flex align-items-center">
										<a [routerLink]="mainMenus.route">{{ mainMenus.data }}</a>
									</li>
									<li class="breadcrumb-item active" aria-current="page">
										{{ mainMenus.data2 }}
									</li>
								</ng-container>

							</ng-container>
						</ol>

					</nav>

				</div>

				<div class="d-flex align-items-center">

					<!-- Search -->
					<div class="input-icon-end position-relative me-2">
						<input type="text" class="form-control" placeholder="Search">
						<span class="input-icon-addon">
							<i class="isax isax-search-normal"></i>
						</span>
					</div>
					<!-- /Search -->

					<!-- Language Selector -->
					<div class="nav-item flag-nav me-2">
						<app-language-selector></app-language-selector>
					</div>

					<!-- Notification -->
					<div class="notification_item me-2">
						<a href="javascript:void(0);" class="btn btn-menubar position-relative" id="notification_popup"
							data-bs-toggle="dropdown" data-bs-auto-close="outside">
							<i class="isax isax-notification-bing5"></i>
							<span *ngIf="unreadCount > 0"
								class="position-absolute badge bg-success border border-white">{{ unreadCount }}</span>
						</a>
						<div class="dropdown-menu p-0 dropdown-menu-end dropdown-menu-lg" style="min-height: 300px;">

							<div class="p-2 border-bottom">
								<div class="row align-items-center">
									<div class="col">
										<h6 class="m-0 fs-16 fw-semibold"> Notifications</h6>
									</div>
									<div class="col-auto">
										<div class="dropdown">
											<a href="javascript:void(0);"
												class="dropdown-toggle drop-arrow-none link-dark"
												data-bs-toggle="dropdown" data-bs-offset="0,15" aria-expanded="false">
												<i class="isax isax-setting-2 fs-16 text-body align-middle"></i>
											</a>
											<div class="dropdown-menu dropdown-menu-end">
												<!-- item-->
												<a href="javascript:void(0);" class="dropdown-item"><i
														class="ti ti-bell-check me-1"></i>Mark as Read</a>
												<!-- item-->
												<a href="javascript:void(0);" class="dropdown-item"><i
														class="ti ti-trash me-1"></i>Delete All</a>
											</div>
										</div>
									</div>
								</div>
							</div>

							<!-- Notification Dropdown -->
							<div class="notification-body position-relative z-2 rounded-0" data-simplebar>

								<!-- Loading State -->
								<div *ngIf="loadingNotifications" class="text-center py-4">
									<div class="spinner-border spinner-border-sm text-primary" role="status">
										<span class="visually-hidden">Loading...</span>
									</div>
								</div>

								<!-- Empty State -->
								<div *ngIf="!loadingNotifications && notifications.length === 0"
									class="text-center py-4">
									<i class="isax isax-notification fs-1 text-muted mb-2"></i>
									<p class="text-muted mb-0">Aucune notification</p>
								</div>

								<!-- Notifications List -->
								<ng-container *ngIf="!loadingNotifications && notifications.length > 0">
									<div *ngFor="let notification of notifications; let i = index"
										class="dropdown-item notification-item py-2 text-wrap border-bottom"
										[class.bg-light]="notification.nsStatut !== 'LU'"
										[id]="'notification-' + notification.id">
										<div class="d-flex">
											<div class="flex-shrink-0">
												<div class="avatar-sm me-2">
													<span
														class="avatar-title bg-soft-primary text-primary fs-18 rounded-circle">
														<i [class]="getNotificationIcon(notification)"></i>
													</span>
												</div>
											</div>
											<div class="flex-grow-1">
												<p class="mb-0 fw-semibold text-dark">{{ notification.nsTitre }}</p>
												<p class="mb-1 text-wrap fs-14">{{ notification.nsMessage }}</p>
												<div class="d-flex justify-content-between align-items-center">
													<span class="fs-12">
														<i class="isax isax-clock me-1"></i>{{
														formatNotificationDate(notification.nsDateCreation) }}
													</span>
													<div
														class="notification-action d-flex align-items-center float-end gap-2">
														<a *ngIf="notification.nsStatut !== 'LU'"
															href="javascript:void(0);"
															class="notification-read rounded-circle bg-info"
															(click)="markNotificationAsRead(notification, $event)"
															data-bs-toggle="tooltip" title="Marquer comme lu"></a>
														<button class="btn rounded-circle text-danger p-0"
															(click)="deleteNotification(notification, $event)">
															<i class="isax isax-close-circle fs-12"></i>
														</button>
													</div>
												</div>
											</div>
										</div>
									</div>
								</ng-container>

							</div>

							<!-- View All-->
							<div class="p-2 rounded-bottom border-top text-center">
								<a [routerLink]="routes.notifications" class="text-center fw-medium fs-14 mb-0">
									View All
								</a>
							</div>

						</div>
					</div>

					<!-- Light/Dark Mode Button -->
					<div class="me-2 theme-item" [ngClass]="{'d-none':base==='layout-dark'}">
						<a href="javascript:void(0);" id="dark-mode-toggle" class="theme-toggle btn btn-menubar"
							[ngClass]="{'activate' : themeColor==='light'}" (click)="sideBar.changeThemeColor('dark')">
							<i class="isax isax-moon"></i>
						</a>
						<a href="javascript:void(0);" id="light-mode-toggle" class="theme-toggle btn btn-menubar"
							[ngClass]="{'activate' : themeColor==='dark'}" (click)="sideBar.changeThemeColor('light')">
							<i class="isax isax-sun-1"></i>
						</a>
					</div>

					<!-- User Dropdown -->
					<div class="dropdown profile-dropdown">
						<a href="javascript:void(0);" class="dropdown-toggle d-flex align-items-center"
							data-bs-toggle="dropdown" data-bs-auto-close="outside">
							<span class="avatar online">
								<img [src]="getUserAvatar()" alt="Img" class="img-fluid rounded-circle">
							</span>
						</a>
						<div class="dropdown-menu p-2">
							<div class="d-flex align-items-center bg-light rounded-1 p-2 mb-2">
								<span class="avatar avatar-lg me-2">
									<img [src]="getUserAvatar()" alt="img" class="rounded-circle">
								</span>
								<div>
									<h6 class="fs-14 fw-medium mb-1">{{ currentUser?.nomPrenom || 'Utilisateur' }}</h6>
									<p class="fs-13">{{ currentUser?.roles?.[0] || 'Administrator' }}</p>
								</div>
							</div>

							<!-- Item-->
							<a class="dropdown-item d-flex align-items-center" [routerLink]="routes.accountSettings">
								<i class="isax isax-profile-circle me-2"></i>Profile Settings
							</a>

							<!-- Item-->
							<a class="dropdown-item d-flex align-items-center" [routerLink]="routes.inventoryReport">
								<i class="isax isax-document-text me-2"></i>Reports
							</a>

							<!-- Item-->
							<div
								class="form-check form-switch form-check-reverse d-flex align-items-center justify-content-between dropdown-item mb-0">
								<label class="form-check-label" for="notify"><i
										class="isax isax-notification me-2"></i>Notifications</label>
								<input class="form-check-input" type="checkbox" role="switch" id="notify">
							</div>

							<hr class="dropdown-divider my-2">

							<!-- Item-->
							<a class="dropdown-item logout d-flex align-items-center" (click)="logOut()">
								<i class="isax isax-logout me-2"></i>Sign Out
							</a>
						</div>
					</div>

				</div>
			</div>
		</div>

		<!-- Mobile Menu -->
		<div class="dropdown mobile-user-menu profile-dropdown">
			<a href="javascript:void(0);" class="dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown"
				data-bs-auto-close="outside">
				<span class="avatar avatar-md online">
					<img [src]="getUserAvatar()" alt="Img" class="img-fluid rounded-circle">
				</span>
			</a>
			<div class="dropdown-menu p-2 mt-0">
				<div class="d-flex align-items-center bg-light rounded-1 p-2 mb-2">
					<span class="avatar avatar-lg me-2">
						<img [src]="getUserAvatar()" alt="img" class="rounded-circle">
					</span>
					<div>
						<h6 class="fs-14 fw-medium mb-1">{{ currentUser?.nomPrenom || 'Utilisateur' }}</h6>
						<p class="fs-13">{{ currentUser?.roles?.[0] || 'Administrator' }}</p>
					</div>
				</div>
				<a class="dropdown-item d-flex align-items-center" [routerLink]="routes.profile">
					<i class="isax isax-profile-circle me-2"></i>Profile Settings
				</a>
				<a class="dropdown-item d-flex align-items-center" [routerLink]="routes.stockSummary">
					<i class="isax isax-document-text me-2"></i>Reports
				</a>
				<a class="dropdown-item d-flex align-items-center" [routerLink]="routes.accountSettings">
					<i class="isax isax-setting me-2"></i>Settings
				</a>
				<a class="dropdown-item logout d-flex align-items-center" (click)="logOut()">
					<i class="isax isax-logout me-2"></i>Signout
				</a>
			</div>
		</div>
		<!-- /Mobile Menu -->

	</div>
</div>